# MeatyMusic AMCS API Environment Configuration
# Copy this file to .env and fill in the values

# Database Configuration
DATABASE_URL=postgresql://mm_user:mm_password@localhost:5432/meaty_music_dev
DATABASE_URL_TEST=postgresql://mm_user:mm_password@localhost:5432/meaty_music_test

# Redis Configuration
REDIS_URL=redis://localhost:6379/0
REDIS_MAX_CONNECTIONS=50
REDIS_HEALTH_CHECK_INTERVAL=30

# Authentication (Clerk)
CLERK_SECRET_KEY=your_clerk_secret_key_here
CLERK_WEBHOOK_SECRET=your_clerk_webhook_secret_here
CLERK_JWKS_URL=https://your-clerk-instance.clerk.accounts.dev/.well-known/jwks.json
CLERK_JWT_ISSUER=https://your-clerk-instance.clerk.accounts.dev
CLERK_JWKS_CACHE_TTL=3600

# Authentication Provider
AUTH_PROVIDER=clerk
AUTH_SIGNING_SECRET=your_auth_signing_secret_here

# Application Configuration
SERVICE_NAME=meatymusic-api
PROJECT_NAME=MeatyMusic
PROJECT_DESCRIPTION=Agentic Music Creation System (AMCS)
API_V1_STR=/api/v1
ENVIRONMENT=development
POSTGRES_DB=meatymusic

# Feature Flags
PROMPT_ENGINE_ENABLED=true

# Observability (OBS_ prefix)
OBS_TRACING_ENABLED=true
OBS_TELEMETRY_ENABLED=true
OBS_LOG_JSON_FORMAT=true
OBS_LOG_LEVEL=INFO
OBS_OTEL_EXPORTER_TYPE=console
# OBS_OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4318

# Structured Logging
OBS_LOG_REQUEST_BODY=false
OBS_LOG_RESPONSE_BODY=false
OBS_LOG_DATABASE_QUERIES=true
OBS_SLOW_QUERY_THRESHOLD=0.1
OBS_MAX_LOG_BODY_SIZE=1024

# Log Sampling and Filtering
OBS_LOG_SAMPLE_RATE=1.0
OBS_LOG_EXCLUDE_PATHS=/healthz,/metrics,/_internal

# Correlation and Context
OBS_CORRELATION_HEADER_NAME=X-Correlation-ID
OBS_REQUEST_ID_HEADER_NAME=X-Request-ID
OBS_ENABLE_PERFORMANCE_LOGGING=true

# Error Handling
OBS_LOG_STACK_TRACES=true
OBS_ERROR_CATEGORIZATION_ENABLED=true

# Cache Configuration (CACHE_ prefix)
CACHE_ENABLED=true
CACHE_DEFAULT_TTL=3600
CACHE_COMPRESSION_ENABLED=true
CACHE_COMPRESSION_THRESHOLD=1024
CACHE_ENABLE_WARMING=true

# L1 (Memory) Cache
CACHE_L1_ENABLED=true
CACHE_L1_MAX_SIZE=1000
CACHE_L1_TTL=300

# L2 (Redis) Cache
CACHE_L2_ENABLED=true
CACHE_L2_CONNECTION_POOL_SIZE=50
CACHE_L2_HEALTH_CHECK_INTERVAL=30

# Cache Strategies
CACHE_MODEL_DATA_TTL=3600
CACHE_MODEL_DATA_PREWARM_COUNT=100
CACHE_PROVIDER_METADATA_TTL=14400
CACHE_PROVIDER_METADATA_PREWARM_ALL=true
CACHE_ALIAS_MAPPINGS_PRIMARY_TTL=1800
CACHE_ALIAS_MAPPINGS_HISTORICAL_TTL=86400
CACHE_PRICING_INFO_TTL=7200

# Metrics Cache
CACHE_METRICS_TTL=300
CACHE_METRICS_SUMMARY_TTL=900
CACHE_METRICS_AVAILABILITY_TTL=1800
CACHE_METRICS_AGGREGATES_TTL=3600

# Performance Targets
CACHE_METRICS_API_RESPONSE_P95_TARGET_MS=200
CACHE_METRICS_CACHE_HIT_RATIO_TARGET=0.95
CACHE_METRICS_PERCENTILE_CALCULATION_P95_TARGET_MS=50

# Monitoring
CACHE_HIT_RATIO_TARGET=0.95
CACHE_MONITORING_ENABLED=true
CACHE_METRICS_COLLECTION_INTERVAL=60

# Tag-based Invalidation
CACHE_TAG_INVALIDATION_ENABLED=true
CACHE_TAG_SET_TTL_BUFFER=300

# Tenant Awareness
CACHE_TENANT_AWARE=true
CACHE_TENANT_KEY_PREFIX=tenant

# Enhanced Operations
CACHE_BATCH_SIZE_LIMIT=1000
CACHE_SCAN_COUNT_DEFAULT=100
CACHE_SLIDING_EXPIRATION_ENABLED=true
CACHE_SLIDING_WINDOW_DEFAULT=300

# Circuit Breaker
CACHE_CIRCUIT_BREAKER_ENABLED=true
CACHE_CIRCUIT_BREAKER_FAILURE_THRESHOLD=5
CACHE_CIRCUIT_BREAKER_RECOVERY_TIMEOUT=60
CACHE_CIRCUIT_BREAKER_LATENCY_THRESHOLD_MS=50.0
CACHE_CIRCUIT_BREAKER_HIT_RATIO_THRESHOLD=0.80

# Performance Monitoring
CACHE_PERFORMANCE_MONITORING_ENABLED=true
CACHE_LATENCY_TRACKING_ENABLED=true
CACHE_HIT_RATIO_TRACKING_ENABLED=true

# Development Auth Bypass (DEVELOPMENT ONLY - DO NOT USE IN PRODUCTION)
DEV_AUTH_BYPASS_ENABLED=false
# DEV_AUTH_BYPASS_SECRET=your_32_character_minimum_secret_here_for_development
DEV_AUTH_BYPASS_USER_ID=dev-user-00000000-0000-0000-0000-000000000000
